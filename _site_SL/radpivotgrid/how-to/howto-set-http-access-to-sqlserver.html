<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Set HTTP access to SQL Server</title>
        <link rel="shortcut icon" href="/devtools/silverlight/favicon.ico"/>
        <meta name="description" content="Set HTTP access to SQL Server">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/silverlight/assets/styles-5bdcfd475585f36df16a95e0457f2f6f.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/theme-d2ae4bb8495446e1d4605832601ddc1a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/branding-a6bed66550d3e9b437d7b25da3bd997a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/app-552278fa51da4b2d25adc25f9fec90be.js"></script>
		<script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
             <div id="page-header">

	<div id="logo-bar-sl">
		<a href="http://www.telerik.com" target="_blank" title="UI for Silverlight">
			<span>UI for Silverlight</span>
		</a>
	</div> 



	<div id="page-search">
        <script>
  (function() {
    var cx = '001595215763381649090:eblhnfskwrk';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

    </div>
</div> 


        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/devtools/silverlight/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/devtools/silverlight/"),
            dataBound: expandNavigation("radpivotgrid/how-to/howto-set-http-access-to-sqlserver.html")
        });
        </script>
    </div>

    <div id="page-article">
        <div id="page-top">
            <div id="page-breadcrumb">
                <ul><li class="link"><a href="/devtools/silverlight/introduction/index">Home</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/overview">RadPivotGrid</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/how-to/howto-set-http-access-to-sqlserver">how-to</a></li><li>Set HTTP access to SQL Server</li></ul>
            </div>
        </div>

        <article>
            <h1 id="set-http-access-to-sql-server"><a href="#set-http-access-to-sql-server">Set HTTP access to SQL Server</a></h1>

<p>In this article we will show you how to setup HTTP access to your Microsoft SQL Analysis Service which is needed if you intend to use XmlaDataProvider.</p>

<blockquote>
<p>As a prerequisite you must have installed Microsoft SQL Server and at least one OLAP Cube to be deployed there.</p>
</blockquote>

<h2 id="communication-between-client-and-server"><a href="#communication-between-client-and-server">Communication between client and server</a></h2>

<p><strong>RadPivotGrid</strong> can communicate with OLAP Cube by using Extensible Markup Language for Analysis (XMLA). XMLA communication is over HTTP protocol where<br>
          <strong>RadPivotGrid</strong> is the client and SQL Analysis Service is the server. Analysis Service provides an XMLA listener compontent that handles all XMLA communications<br>
          between Analysis Services and its clients. Analysis Service uses Internet Information Services (IIS) as a middleware component to enable access to data via HTTP. The communication is executed<br>
          as follows:</p>

<ol>
<li><p>RadPivotGrid sends an HTTP post request to IIS using the IIS servername and path to service component (msmdpump.dll) as url.</p></li>
<li><p>IIS receives the request, authenticates the sender, and creates a security context in which the pump will be executed.</p></li>
<li><p>IIS starts pump and uses Internet Server Application Programming Interface (<a href="http://en.wikipedia.org/wiki/Internet_Server_Application_Programming_Interface">ISAPI</a>) to communicate with pump.</p></li>
<li><p>The pump connects to Analysis Service via TCP/IP and sends data received from RadPivotGrid without any change.</p></li>
<li><p>Analysis Service executes the request and sends response to pump which passes response to <strong>RadPivotGrid</strong>.</p></li>
</ol>

<h2 id="configuring-internet-information-services-iis"><a href="#configuring-internet-information-services-iis">Configuring Internet Information Services (IIS)</a></h2>

<p>If you have not installed Internet Information Services(IIS) you can do it as described below:</p>

<ul>
<li><p>Open "Control Panel" and select "Programs".</p></li>
<li><p>From "Programs and Features" menu choose "Turn Windows features on or off":<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_1.png" alt="Rad Pivot Grid How To Set Http Access To Cube 1"></p></li>
<li><p>In the opened window find the folder Internet Information Services where you can find the features we need. The easiest and most suitable solution is to install everything and this way<br>
          get things out of trouble, but the only mandatory things are: Web Management Tools, .NET Extensibility, ASP.NET, ISAPI Extensions, Basic Authentication and Windows Authentication.<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_2.png" alt="Rad Pivot Grid How To Set Http Access To Cube 2"></p></li>
<li><p>When you click OK, IIS will be installed.</p></li>
</ul>

<p>It is time to configure our Internet Information Service (IIS). To do it start Internet Information Services Manager (just write IIS in the Start menu search and you will find it).</p>

<ol>
<li><p>In the IIS Manager right-click on Application Pools and click on Add New Application Pool. In the new window set this configuration:<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_3.png" alt="Rad Pivot Grid How To Set Http Access To Cube 3"><img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_4.png" alt="Rad Pivot Grid How To Set Http Access To Cube 4"></p></li>
<li><p>Create folder called OLAP under C:\inetpub\wwwRoot.</p></li>
<li><p>Copy the files msmdpump.dll, msmdpump.ini from "<em>Installation Folder</em>\Microsoft SQL Server\MSAS10_50.MSSQLSERVER\OLAP\bin\isapi to C:\inetpub\wwwRoot\OLAP folder.</p></li>
</ol>

<blockquote>
<p>The path may be slightly different based on the installed version of MS SQL Server.</p>
</blockquote>

<ol>
<li><p>Go to IIS and find OLAP folder under Default Web Site. Right Click on it and choose Convert to Application. Click OK to complete the operation.</p></li>
<li><p>Go to Handler Mappings option and double-click it (or use the "Open Feature" Action in the top right corner) then select "Edit Feature Permission" and make sure the directoy has "Read" and "Script" permissions.<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_5.png" alt="Rad Pivot Grid How To Set Http Access To Cube 5"><img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_6.png" alt="Rad Pivot Grid How To Set Http Access To Cube 6"></p></li>
<li><p>In the top right coner of the "Handler Mappings" screen, click "Add Script Map...". And add following information.<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_7.png" alt="Rad Pivot Grid How To Set Http Access To Cube 7"></p></li>
<li><p>When you click OK a warning message will be raised - click yes to confirm that you want to allow ISAPI extension.<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_8.png" alt="Rad Pivot Grid How To Set Http Access To Cube 8"></p></li>
<li><p>After that on IIS go to "Application Pool" and select "ISAPI and CGI Restrictions" under security.<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_9.png" alt="Rad Pivot Grid How To Set Http Access To Cube 9"></p></li>
<li><p>Find the item with the Path to your OLAP application (msmdpump.dll) and double-click it to add a description:<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_10.png" alt="Rad Pivot Grid How To Set Http Access To Cube 10"><img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_11.png" alt="Rad Pivot Grid How To Set Http Access To Cube 11"></p></li>
<li><p>The last thing we have to set is the Authentication mode. From the OLAP virtual directory choose "Authentication". There are several different modes that you may use.<br>
          More information about them can be found<br>
          <a href="http://msdn.microsoft.com/en-us/library/aa292114(v=vs.71).aspx">here</a>.<br>
          There most important thing that you have to remember is that the default user used by IIS is <strong>IUSR</strong>. There are two common problems you may face:</p></li>
</ol>

<ul>
<li><p>Change the authentication mode in IIS and give access to other users instead of IUSR - this is okay for your security restrictions, but you have to apply your changes<br>
              in the Analysis Services as well.</p></li>
<li><p>Use the default authentication mode - this way IUSR user will be used to connect to Analysis Service. It is mandatory to give this user privileges in the Analysis Service. <br>
            To grant access to a specific user in your Analysis Service open a connection to your cube with Microsoft SQL Server Management Studio and add a new Role:<br>
        <img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_12.png" alt="Rad Pivot Grid How To Set Http Access To Cube 12"><img src="images/RadPivotGrid_HowTo_SetHttpAccessToCube_13.png" alt="Rad Pivot Grid How To Set Http Access To Cube 13"></p></li>
</ul>

<blockquote class="important"><p>In the General Tab above you can set database permissions for this role. Your users will need at least Read permissions.</p></blockquote>
                

<p>After applying this you should be able to use XmlaDataProvider in your <strong>RadPivotGrid</strong> to access the data from your Cube.</p>

<p>To enable a Silverlight control to access a service in another domain, the service must explicitly opt-in to allow cross-domain access.<br>
            By opting-in, a service states that the operations it exposes can safely be invoked by a Silverlight control, without potentially damaging consequences to the data that the service stores.<br>
            That's why you have to place a clientaccesspolicy.xml file at the root of the domain where the service is hosted to configure the service to allow cross-domain access.<br>
            The following configuration allows access from any other domain to all resources on the current domain.</p>

<h4><strong>XML</strong></h4>

<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;access-policy&gt;
  &lt;cross-domain-access&gt;
    &lt;policy&gt;
      &lt;allow-from http-request-headers="SOAPAction"&gt;
        &lt;domain uri="*"/&gt;
      &lt;/allow-from&gt;
      &lt;grant-to&gt;
        &lt;resource path="/" include-subpaths="true"/&gt;
      &lt;/grant-to&gt;
    &lt;/policy&gt;
  &lt;/cross-domain-access&gt;
&lt;/access-policy&gt;
</code></pre>

<p>If you use Authentication for your service, you should add Authorization in the http-request-headers:  <strong>http-request-headers="SOAPAction,Authorization"</strong>.<br>
            More information about clientaccespolicy can be found<br>
            <a href="http://msdn.microsoft.com/en-us/library/cc197955(v=vs.95).aspx">here</a>.</p>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/silverlight/radpivotgrid/getting-started">Getting Started</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/fieldlist">RadPivotFieldList</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/populating-with-data/data-xmla">Using XmlaDataProvider</a></p></li>
</ul>
        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik. All rights reserved.</p>
</footer>


    </body>
</html>

