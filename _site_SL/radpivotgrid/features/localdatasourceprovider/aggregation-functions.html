<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Aggregate Functions</title>
        <link rel="shortcut icon" href="/devtools/silverlight/favicon.ico"/>
        <meta name="description" content="Aggregate Functions">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/silverlight/assets/styles-5bdcfd475585f36df16a95e0457f2f6f.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/theme-d2ae4bb8495446e1d4605832601ddc1a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/branding-a6bed66550d3e9b437d7b25da3bd997a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/app-552278fa51da4b2d25adc25f9fec90be.js"></script>
		<script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
             <div id="page-header">

	<div id="logo-bar-sl">
		<a href="http://www.telerik.com" target="_blank" title="UI for Silverlight">
			<span>UI for Silverlight</span>
		</a>
	</div> 



	<div id="page-search">
        <script>
  (function() {
    var cx = '001595215763381649090:eblhnfskwrk';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

    </div>
</div> 


        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/devtools/silverlight/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/devtools/silverlight/"),
            dataBound: expandNavigation("radpivotgrid/features/localdatasourceprovider/aggregation-functions.html")
        });
        </script>
    </div>

    <div id="page-article">
        <div id="page-top">
            <div id="page-breadcrumb">
                <ul><li class="link"><a href="/devtools/silverlight/introduction/index">Home</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/overview">RadPivotGrid</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/features/layouts">Features1</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/features/localdatasourceprovider/aggregation-functions">localdatasourceprovider</a></li><li>Aggregate Functions</li></ul>
            </div>
        </div>

        <article>
            <h1 id="aggregate-functions"><a href="#aggregate-functions">Aggregate Functions</a></h1>

<p>In this article we will show how to use and change aggregate functions in <strong>RadPivotGrid</strong> and <strong>RadPivotFieldList</strong>.</p>

<blockquote>
<p>Different aggregate functions are available only for LocalDataSourceProvider. When your data source is OLAP Cube, the data is already aggregated in it and you cannot apply new aggregate function.</p>
</blockquote>

<h2 id="items-source"><a href="#items-source">Items Source</a></h2>

<p>In our application we will use a very simple ItemsSource for our LocalDataSourceProvider and we will change only the aggregated functions just to show the different result in <strong>RadPivotGrid</strong>.</p>

<table>
<th></th>
<tr>
<td>

Name</td>
<td>

Promotion</td>
<td>

Price</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Extra Discount</td>
<td>

10.61</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Extra Discount</td>
<td>

10.82</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Extra Discount</td>
<td>

11.24</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Free shipping</td>
<td>

10.47</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Free shipping</td>
<td>

11.14</td>
</tr>
<tr>
<td>

Pen</td>
<td>

Free shipping</td>
<td>

10.89</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Extra Discount</td>
<td>

8.82</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Extra Discount</td>
<td>

8.95</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Extra Discount</td>
<td>

7.12</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Free shipping</td>
<td>

8.63</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Free shipping</td>
<td>

7.28</td>
</tr>
<tr>
<td>

Pencil</td>
<td>

Free shipping</td>
<td>

7.59</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Extra Discount</td>
<td>

22.86</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Extra Discount</td>
<td>

23.02</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Extra Discount</td>
<td>

23.22</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Free shipping</td>
<td>

21.99</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Free shipping</td>
<td>

22.45</td>
</tr>
<tr>
<td>

Notebook</td>
<td>

Free shipping</td>
<td>

22.56</td>
</tr>
</table>

<p>We will use <em>Name</em> as <em>RowGroupDescription</em>, <em>Promotion</em> as <em>ColumnGroupDescription</em><br>
          and <em>Price</em> as <em>AggregateDescription</em>.</p>

<h2 id="aggregate-functions"><a href="#aggregate-functions">Aggregate Functions</a></h2>

<p><strong>RadPivotGrid</strong> is designed to aggregate data. Aggregated data is shown in the cells.<br>
          You can set different aggregate functions to change the view of your <strong>RadPivotGrid</strong>. The chosen function is applied on the data in the cells and on the GrandTotals as well:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_01.png" alt="Rad Pivot Grid Features Aggregate Functions 01"></p>

<p>On the image you can see <strong>RadPivotGrid</strong> with Price defined as PropertyAggregateDescription with Average function. Note how the data is grouped together and an aggregate function<br>
          is applied:</p>

<ul>
<li><p>Data is aggregated in the cells - check the red rectangle - it shows 23.03 which is the average of the values for all Notebooks with Extra Discount promotions.</p></li>
<li><p>GrandTotals use the same aggregate function - as you can see in the Green and Blue rectangles, GrandTotals for Rows and Columns are using the same aggregate function - average. <br>
          So in the Blue rectange you can see that the average price of all products with Free shipping promotion is 13.67. In the Green rectangle you can check easily that the average price<br>
          of all Pens is 10.86.</p></li>
<li><p>The average of GrandTotals for columns is the same as average of GrandTotals for rows. The value in the bottom right corner is calculated with the aggregate function applied on the GrandTotals.<br>
          There shouldn't be any difference whether you apply the aggregate function on the GrandTotals of the rows or of the columns.</p></li>
</ul>

<p>Here is a full list with the functions you can use:</p>

<ul>
<li><p><strong>Average</strong> - this function will sum all data and then divide it to the number of items. For example we have three products "Pen" with "Extra Discount" promotion. In RadPivotGrid<br>
          you can see the average price. The calculation is simple - sum the prices of the three products (10.61 + 10.82 + 11.24 = 32.67). Now divide it to the count of items (32.67 / 3 = 10.89).</p></li>
<li><p><strong>Count</strong> - this function will count the items - in our example there are three products "Pen" with "Extra Discount" promotion, so in the matching cell you will see number 3:</p></li>
<li><p><strong>Max</strong> - this function will show the highest value of all possible for the current cell - for product "Pen" with "Extra Discount" promotion we have prices 10.61, 10.82, 11.24. The highest value is<br>
          11.24 so it will be shown in the cell.</p></li>
<li><p><strong>Min</strong> - this function will show the lowest value of all possible for the current cell - for product "Pen" with "Extra Discount" promotion we have prices 10.61, 10.82, 11.24. The lowest value is<br>
          10.61 so it will be shown in the cell.</p></li>
<li><p><strong>Product</strong> - this function is doing multiplication of the values - for product "Pen" with "Extra Discount" promotion we have prices 10.61, 10.82, 11.24. So the Product function will be:<br>
          10.61 * 10.82 * 11.24 = 1290.35</p></li>
<li><p><strong>StdDev</strong> - this function is calculating the standard deviation based on a sample. The standard deviation is a measure of how widely values are dispersed from the average value. The formula is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_02.png" alt="Rad Pivot Grid Features Aggregate Functions 02">So for product "Pen" in promotion "Extra Discount" the standard deviation is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_04.png" alt="Rad Pivot Grid Features Aggregate Functions 04"><img src="images/RadPivotGrid_Features_Aggregate_Functions_03.png" alt="Rad Pivot Grid Features Aggregate Functions 03"></p></li>
<li><p><strong>StdDevP</strong> - this function is calculating the standard deviation based on the entire population given as arguments. The standard deviation is a measure of how widely values are dispersed from the average value.<br>
          The formula is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_05.png" alt="Rad Pivot Grid Features Aggregate Functions 05">So for product "Pen" in promotion "Extra Discount" the StdDevP is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_04.png" alt="Rad Pivot Grid Features Aggregate Functions 04"><img src="images/RadPivotGrid_Features_Aggregate_Functions_06.png" alt="Rad Pivot Grid Features Aggregate Functions 06"></p></li>
<li><p><strong>Sum</strong> - this function will sumarize all values. For product "Pen" in promotion "Extra Discount" the value in the cell will be 10.61 + 10.82 + 11.24 = 32.67.</p></li>
<li><p><strong>Var</strong> - estimates variance based on a sample. The formula is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_07.png" alt="Rad Pivot Grid Features Aggregate Functions 07">So for product "Pen" in promotion "Extra Discount" the variance is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_04.png" alt="Rad Pivot Grid Features Aggregate Functions 04"><img src="images/RadPivotGrid_Features_Aggregate_Functions_08.png" alt="Rad Pivot Grid Features Aggregate Functions 08"></p></li>
<li><p><strong>VarP</strong> - calculates variance based on the entire population. The formula is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_09.png" alt="Rad Pivot Grid Features Aggregate Functions 09">So for product "Pen" in promotion "Extra Discount" the variance is:<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_04.png" alt="Rad Pivot Grid Features Aggregate Functions 04"><img src="images/RadPivotGrid_Features_Aggregate_Functions_10.png" alt="Rad Pivot Grid Features Aggregate Functions 10"></p></li>
</ul>

<h2 id="defining-aggregate-function"><a href="#defining-aggregate-function">Defining Aggregate Function</a></h2>

<p>You can define Aggregate function in the <strong>XAML</strong>, in code behind or even at runtime by using <strong>RadPivotFieldList</strong>.</p>

<p>Aggregate Function is defined on PropertyAggregateDescription. There is property AggregateFunction which should be set in one of the following ways:</p>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:PropertyAggregateDescription PropertyName="Price" AggregateFunction="StdDevP" /&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>PropertyAggregateDescription aggregate = new PropertyAggregateDescription();
aggregate.PropertyName = "Price";
aggregate.AggregateFunction = AggregateFunctions.StdDevP;
</code></pre>

<h4><strong>VB.NET</strong></h4>

<p>You can change applied Aggregate Function at runtime by using <strong>RadPivotFieldList</strong>. Just find the aggregate description which you want to modify<br>
          in the "Values" list and click on it - some of the aggregate functions are listed there, but if you don't see the one you need - click on "More aggregate Options..." item<br>
          and a new dialog <strong>RadWindow</strong> will open. In it you will find all predefined Aggregate Functions.<br>
        <img src="images/RadPivotGrid_Features_Aggregate_Functions_11.png" alt="Rad Pivot Grid Features Aggregate Functions 11"><img src="images/RadPivotGrid_Features_Aggregate_Functions_12.png" alt="Rad Pivot Grid Features Aggregate Functions 12"></p>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/silverlight/radpivotgrid/getting-started">Getting Started</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/fieldlist">RadPivotFieldList</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/populating-with-data/data-localdatasource">LocalDataSourceProvider</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/features">Features</a></p></li>
</ul>
        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik. All rights reserved.</p>
</footer>


    </body>
</html>

