<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Export</title>
        <link rel="shortcut icon" href="/devtools/silverlight/favicon.ico"/>
        <meta name="description" content="Export">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/silverlight/assets/styles-5bdcfd475585f36df16a95e0457f2f6f.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/theme-d2ae4bb8495446e1d4605832601ddc1a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/branding-a6bed66550d3e9b437d7b25da3bd997a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/app-552278fa51da4b2d25adc25f9fec90be.js"></script>
		<script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
             <div id="page-header">

	<div id="logo-bar-sl">
		<a href="http://www.telerik.com" target="_blank" title="UI for Silverlight">
			<span>UI for Silverlight</span>
		</a>
	</div> 



	<div id="page-search">
        <script>
  (function() {
    var cx = '001595215763381649090:eblhnfskwrk';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

    </div>
</div> 


        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/devtools/silverlight/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/devtools/silverlight/"),
            dataBound: expandNavigation("radpivotgrid/features/export.html")
        });
        </script>
    </div>

    <div id="page-article">
        <div id="page-top">
            <div id="page-breadcrumb">
                <ul><li class="link"><a href="/devtools/silverlight/introduction/index">Home</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/overview">RadPivotGrid</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/features/layouts">Features1</a></li><li>Export</li></ul>
            </div>
        </div>

        <article>
            <h1 id="export"><a href="#export">Export</a></h1>

<p><strong>RadPivotGrid</strong> offers you great export capabilities. <strong>RadPivotGrid</strong> has GenerateExport method, which you can use to export the data to different formats. In this article we'll show you<br>
        how to export <strong>RadPivotGrid</strong> to the following formats: xlsx (Microsoft Excel), docx (Microsoft Word), pdf and HTML. </p>

<h2 id="common-export-explanation"><a href="#common-export-explanation">Common Export Explanation</a></h2>

<p><strong>RadPivotGrid</strong> has <em>GenerateExport</em> method. It is of type <em>PivotExportModel</em> and is used to generate the data that will be exported.<br>
          No matter which output format you have chosen, you will have to call the GenerateExport method. The <em>PivotExportModel</em> holds Row and Column count and information about different properties<br>
          of each cell.</p>

<p><strong>RadPivotGrid</strong> will be exported with all rows and columns expanded, no matter if you have collapsed some of them. If you want to export to docx, pdf or HTML format, you will have to use <strong>RadRichTextBox</strong> and set<br>
          its Document property. More information is available in the article below.</p>

<blockquote class="important"><p>If you want to use export to specific format, you will have to add additional assemblies to your application. In the article below you will find more information which assemblies you need for particular export type.</p></blockquote>
          

<blockquote>
<p>To export <strong>RadPivotGrid</strong> with all colors and fonts applied, you have to set the QuickStyle property. It is set to default value when <strong>RadPivotGrid</strong> is loaded, so if you have not set it, you must show the pivot at least once before exporting it.</p>
</blockquote>

<h2 id="export-to-excel"><a href="#export-to-excel">Export To Excel</a></h2>

<blockquote>
<p>In order to use Export to xlsx (Excel) format, you will have to add reference to the following assemblies:</p>
</blockquote>

<ul>
<li><p><strong>Telerik.Windows.Documents.Spreadsheet</strong></p></li>
<li><p><strong>Telerik.Windows.Documents.Spreadsheet.FormatProviders.OpenXml</strong></p></li>
</ul>

<p>In order to export <strong>RadPivotGrid</strong> to xlsx format (Excel file), you have to use <strong>XlsxFormatProvider</strong> from*Telerik.Windows.Documents.Spreadsheet.FormatProviders.OpenXml.Xlsx* namespace. The <strong>XlsxFormatProvider</strong><br>
          has <em>Export</em> method, which has two arguments - first one is a Workbook that has to be exported and the second one is the output stream. In our case we'll create a simple Workbook (instance of <em>Telerik.Windows.Documents.Spreadsheet.Model.Workbook</em>) with<br>
          a single Worksheet (instance of <em>Telerik.Windows.Documents.Spreadsheet.Model.Workbook</em>) in it.</p>

<p>Our first task is to get needed information from <strong>RadPivotGrid</strong> by using Export method. After that we'll create a new Workbook and new Stylesheet. By using the information from the Export method, we'll set the cells in the stylesheet and we'll set the FontSize, FontFamily, Fill, Indent, Value, Borders, etc.<br>
          The final step is to use the <strong>XlsxFormatProvider</strong> and its Export method, which will help us to create the xlsx file.</p>

<blockquote>
<p>You can use the method below and call it on a click of a button for example. By using it, <strong>RadPivotGrid</strong> will be exported with the same fonts and colors as it is in your application.<br>
            You can remove the properties, which you do not want to export (for example fill, indent or alignment).</p>
</blockquote>

<h4><strong>C#</strong></h4>

<pre><code>private void ExportToExcel()
{
    SaveFileDialog dialog = new SaveFileDialog();
    dialog.DefaultExt = "xlsx";
    dialog.Filter = "Excel Workbook (xlsx) | *.xlsx |All Files (*.*) | *.*";

    var result = dialog.ShowDialog();
    if ((bool)result)
    {
        try
        {
            using (var stream = dialog.OpenFile())
            {
                var workbook = GenerateWorkbook();

                XlsxFormatProvider provider = new XlsxFormatProvider();
                provider.Export(workbook, stream);
            }
        }
        catch (IOException ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
}

private Workbook GenerateWorkbook()
{
    var export = pivot.GenerateExport();

    Workbook workbook = new Workbook();
    workbook.History.IsEnabled = false;

    var worksheet = workbook.Worksheets.Add();

    workbook.SuspendLayoutUpdate();
    int rowCount = export.RowCount;
    int columnCount = export.ColumnCount;

    var allCells = worksheet.Cells[0, 0, rowCount - 1, columnCount - 1];
    allCells.SetFontFamily(new ThemableFontFamily(pivot.FontFamily));
    allCells.SetFontSize(12);
    allCells.SetFill(GenerateFill(pivot.Background));

    foreach (var cellInfo in export.Cells)
    {
        int rowStartIndex = cellInfo.Row;
        int rowEndIndex = rowStartIndex + cellInfo.RowSpan - 1;
        int columnStartIndex = cellInfo.Column;
        int columnEndIndex = columnStartIndex + cellInfo.ColumnSpan - 1;

        CellSelection cellSelection = worksheet.Cells[rowStartIndex, columnStartIndex];

        var value = cellInfo.Value;
        if (value != null)
        {
            cellSelection.SetValue(Convert.ToString(value));
            cellSelection.SetVerticalAlignment(RadVerticalAlignment.Center);
            cellSelection.SetHorizontalAlignment(GetHorizontalAlignment(cellInfo.TextAlignment));
            int indent = cellInfo.Indent;
            if (indent &gt; 0)
            {
                cellSelection.SetIndent(indent);
            }
        }

        cellSelection = worksheet.Cells[rowStartIndex, columnStartIndex, rowEndIndex, columnEndIndex];

        SetCellProperties(cellInfo, cellSelection);
    }

    for (int i = 0; i &lt; columnCount; i++)
    {
        var columnSelection = worksheet.Columns[i];
        columnSelection.AutoFitWidth();

        //NOTE: workaround for incorrect autofit.
        var newWidth = worksheet.Columns[i].GetWidth().Value.Value + 15;
        columnSelection.SetWidth(new ColumnWidth(newWidth, false));
    }

    workbook.ResumeLayoutUpdate();
    return workbook;
}

private RadHorizontalAlignment GetHorizontalAlignment(TextAlignment textAlignment)
{
    switch (textAlignment)
    {
        case TextAlignment.Center:
            return RadHorizontalAlignment.Center;

        case TextAlignment.Left:
            return RadHorizontalAlignment.Left;

        case TextAlignment.Right:
            return RadHorizontalAlignment.Right;

        case TextAlignment.Justify:
        default:
            return RadHorizontalAlignment.Justify;
    }
}

private static void SetCellProperties(PivotExportCellInfo cellInfo, CellSelection cellSelection)
{
    var fill = GenerateFill(cellInfo.Background);
    if (fill != null)
    {
        cellSelection.SetFill(fill);
    }

    SolidColorBrush solidBrush = cellInfo.Foreground as SolidColorBrush;
    if (solidBrush != null)
    {
        cellSelection.SetForeColor(new ThemableColor(solidBrush.Color));
    }

    if (cellInfo.FontWeight.HasValue &amp;&amp; cellInfo.FontWeight.Value != FontWeights.Normal)
    {
        cellSelection.SetIsBold(true);
    }

    SolidColorBrush solidBorderBrush = cellInfo.BorderBrush as SolidColorBrush;
    if (solidBorderBrush != null &amp;&amp; cellInfo.BorderThickness.HasValue)
    {
        var borderThickness = cellInfo.BorderThickness.Value;
        var color = new ThemableColor(solidBorderBrush.Color);
        var leftBorder = new CellBorder(GetBorderStyle(borderThickness.Left), color);
        var topBorder = new CellBorder(GetBorderStyle(borderThickness.Top), color);
        var rightBorder = new CellBorder(GetBorderStyle(borderThickness.Right), color);
        var bottomBorder = new CellBorder(GetBorderStyle(borderThickness.Bottom), color);
        var insideBorder = cellInfo.Background != null ? new CellBorder(CellBorderStyle.None, color) : null;
        cellSelection.SetBorders(new CellBorders(leftBorder, topBorder, rightBorder, bottomBorder, insideBorder, insideBorder, null, null));
    }
}

private static CellBorderStyle GetBorderStyle(double thickness)
{
    if (thickness &lt; 1)
    {
        return CellBorderStyle.None;
    }   
    else if (thickness &lt; 2)
    {
        return CellBorderStyle.Thin;
    }
    else if (thickness &lt; 3)
    {
        return CellBorderStyle.Medium;
    }
    else
    {
        return CellBorderStyle.Thick;
    }
}

private static IFill GenerateFill(Brush brush)
{
    if (brush != null)
    {
        SolidColorBrush solidBrush = brush as SolidColorBrush;
        if (solidBrush != null)
        {
            return PatternFill.CreateSolidFill(solidBrush.Color);
        }
    }

    return null;
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<h2 id="export-to-word-pdf-and-html"><a href="#export-to-word-pdf-and-html">Export To Word, Pdf and HTML</a></h2>

<blockquote>
<p>In order to Export to docx, pdf or HTML format, you will have to add reference to the following assemblies:</p>
</blockquote>

<ul>
<li><p><strong>Telerik.Windows.Documents</strong></p></li>
<li><p>__Telerik.Windows.Documents.Core__Based on the format you have selected, you have to add reference to one more assembly. More information is available in the sections below.</p></li>
</ul>

<p>No matter which of these three formats you have chosen, you will have to create a new <strong>RadDocument</strong>, which will hold the content, that will be exported. After that, you have to set this <strong>RadDocument</strong> instance<br>
          to the Document property of <strong>RadRichTextBox</strong>. This <strong>RadRichTextBox</strong> must be visualized in order to be able to export its data. To generate <strong>RadDocument</strong> you can use the code below:</p>

<blockquote class="tip"><p>You can put <strong>RadRichTextBox</strong> as a content of a <strong>RadWindow</strong> and use the window as PrintPreview dialog. You can check a full implementation of this solution in our</p></blockquote>

<pre><code>        [Export](http://demos.telerik.com/silverlight/#PivotGrid/Export) demo. If you do not want to show PrintPreview dialog, you can set the visibility of the window to collapsed.
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>private RadDocument GenerateRadDocument()
{
    var export = pivot.GenerateExport();
    int rowCount = export.RowCount;
    int columnCount = export.ColumnCount;

    RadDocument document = new RadDocument();
    document.SectionDefaultPageMargin = new Telerik.Windows.Documents.Layout.Padding(10);
    document.LayoutMode = DocumentLayoutMode.Paged;
    document.SectionDefaultPageOrientation = PageOrientation.Landscape;
    document.Style.SpanProperties.FontFamily = pivot.FontFamily;
    document.Style.SpanProperties.FontSize = pivot.FontSize;
    document.Style.ParagraphProperties.SpacingAfter = 0;

    var section = new Telerik.Windows.Documents.Model.Section();
    document.Sections.Add(section);
    section.Blocks.Add(new Paragraph());

    var table = new Table(rowCount, columnCount);
    section.Blocks.Add(table);

    var tableRows = table.Rows.ToArray();
    foreach (var cellInfo in export.Cells)
    {
        int rowStartIndex = cellInfo.Row;
        int rowEndIndex = rowStartIndex + cellInfo.RowSpan - 1;
        int columnStartIndex = cellInfo.Column;
        int columnEndIndex = columnStartIndex + cellInfo.ColumnSpan - 1;

        var value = cellInfo.Value;
        var text = Convert.ToString(value);
        if (!string.IsNullOrWhiteSpace(text))
        {
            var cells = tableRows[rowStartIndex].Cells.ToArray();
            var cell = cells[columnStartIndex];
            Paragraph paragraph = new Paragraph();
            cell.Blocks.Add(paragraph);
            var span = new Span(text);
            paragraph.Inlines.Add(span);
            paragraph.TextAlignment = GetTextAlignment(cellInfo.TextAlignment);

            if (cellInfo.FontWeight.HasValue)
            {
                span.FontWeight = cellInfo.FontWeight.Value;
            }

            Color foreColor;
            if (GetColor(cellInfo.Foreground, out foreColor))
            {
                span.ForeColor = foreColor;
            }

            cell.VerticalAlignment = GetVerticalAlignment(cellInfo.VerticalAlignment);
            paragraph.LeftIndent = cellInfo.Indent * 20;
        }

        var borderThickness = cellInfo.BorderThickness;
        var borderBrush = cellInfo.BorderBrush;
        var background = cellInfo.Background;

        Color backColor;
        bool hasBackground = GetColor(cellInfo.Background, out backColor);

        if (cellInfo.RowSpan &gt; 1 &amp;&amp; cellInfo.ColumnSpan &gt; 1)
        {
            for (int k = rowStartIndex; k &lt;= rowEndIndex; k++)
            {
                var cells = tableRows[k].Cells.ToArray();
                for (int j = columnStartIndex; j &lt;= columnEndIndex; j++)
                {
                    var cell = cells[j];
                    if (hasBackground)
                    {
                        cell.Background = backColor;
                    }

                    cell.Borders = GetCellBorders(borderThickness, borderBrush, cell.Borders, k, rowStartIndex, rowEndIndex, j, columnStartIndex, columnEndIndex, hasBackground);
                }

            }
        }
        else if (cellInfo.RowSpan &gt; 1)
        {
            for (int j = rowStartIndex; j &lt;= rowEndIndex; j++)
            {
                // TODO: check when ColumnSpan &gt; 1;
                var cell = tableRows[j].Cells.ToArray()[columnStartIndex];

                Position position = j == rowStartIndex ? Position.First : ((j == rowEndIndex) ? Position.Last : Position.Middle);

                cell.Borders = GetCellBorders(borderThickness, borderBrush, position, cell.Borders, true, cellInfo.Background != null);
                if (hasBackground)
                {
                    cell.Background = backColor;
                }
            }
        }
        else if (cellInfo.ColumnSpan &gt; 1)
        {
            var cells = tableRows[rowStartIndex].Cells.ToArray();
            for (int j = columnStartIndex; j &lt;= columnEndIndex; j++)
            {
                // TODO: check when RowSpan &gt; 1;
                var cell = cells[j];

                Position position = j == columnStartIndex ? Position.First : ((j == columnEndIndex) ? Position.Last : Position.Middle);
                if (hasBackground)
                {
                    cell.Background = backColor;
                }

                cell.Borders = GetCellBorders(borderThickness, borderBrush, position, cell.Borders, false, hasBackground);
            }
        }
    }

    return document;
}

private enum Position
{
    First,
    Middle,
    Last
}

private bool GetColor(Brush brush, out Color color)
{
    SolidColorBrush solidBrush = brush as SolidColorBrush;
    if (solidBrush != null)
    {
        color = solidBrush.Color;
        return true;
    }

    color = Colors.White;
    return false;
}

private TableCellBorders GetCellBorders(Thickness? borderThickness, Brush borderBrush, TableCellBorders cellBorders,
    int rowIndex, int rowStartIndex, int rowEndIndex, int columnIndex, int columnStartIndex, int columnEndIndex, bool hasBackground)
{
    Color borderBrushColor;
    GetColor(borderBrush, out borderBrushColor);

    if (!borderThickness.HasValue)
    {
        return new TableCellBorders(new Telerik.Windows.Documents.Model.Border(BorderStyle.None));
    }

    var thickness = borderThickness.Value;
    Telerik.Windows.Documents.Model.Border topBorder = cellBorders.Top;
    Telerik.Windows.Documents.Model.Border bottomBorder = cellBorders.Bottom;
    Telerik.Windows.Documents.Model.Border leftBorder = cellBorders.Left;
    Telerik.Windows.Documents.Model.Border rightBorder = cellBorders.Right;

    if (rowIndex == rowStartIndex)
    {
        topBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Top, BorderStyle.Single, borderBrushColor);
    }

    if (rowIndex == rowEndIndex)
    {
        bottomBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Bottom, BorderStyle.Single, borderBrushColor);
    }

    if (rowStartIndex &lt; rowIndex &amp;&amp; rowIndex &lt; rowEndIndex)
    {
        topBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Top;
        bottomBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Bottom;
    }

    if (columnIndex == columnStartIndex)
    {
        leftBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Left, BorderStyle.Single, borderBrushColor);
    }

    if (columnIndex == columnEndIndex)
    {
        rightBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Right, BorderStyle.Single, borderBrushColor);
    }

    if (columnStartIndex &lt; columnIndex &amp;&amp; columnIndex &lt; columnEndIndex)
    {
        leftBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Left;
        rightBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Right;
    }

    return new TableCellBorders(leftBorder, topBorder, rightBorder, bottomBorder);
}

private TableCellBorders GetCellBorders(Thickness? borderThickness, Brush borderBrush, Position position, TableCellBorders cellBorders, bool isRow, bool hasBackground)
{
    Color borderBrushColor;
    GetColor(borderBrush, out borderBrushColor);

    if (!borderThickness.HasValue)
    {
        return new TableCellBorders(new Telerik.Windows.Documents.Model.Border(BorderStyle.None));
    }

    var thickness = borderThickness.Value;
    if (isRow)
    {
        var leftBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Left, BorderStyle.Single, borderBrushColor);
        var rightBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Right, BorderStyle.Single, borderBrushColor);
        Telerik.Windows.Documents.Model.Border topBorder;
        Telerik.Windows.Documents.Model.Border bottomBorder;
        switch (position)
        {
            case Position.First:
                topBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Top, BorderStyle.Single, borderBrushColor);
                bottomBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Bottom;
                break;

            case Position.Middle:
                topBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Top;
                bottomBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Bottom;
                break;

            case Position.Last:
            default:
                topBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Top;
                bottomBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Bottom, BorderStyle.Single, borderBrushColor);
                break;
        }

        return new TableCellBorders(leftBorder, topBorder, rightBorder, bottomBorder);
    }
    else
    {
        var topBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Top, BorderStyle.Single, borderBrushColor);
        var bottomBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Bottom, BorderStyle.Single, borderBrushColor);
        Telerik.Windows.Documents.Model.Border leftBorder;
        Telerik.Windows.Documents.Model.Border rightBorder;
        switch (position)
        {
            case Position.First:
                leftBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Left, BorderStyle.Single, borderBrushColor);
                rightBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Right;
                break;

            case Position.Middle:
                leftBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Left;
                rightBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Right;
                break;

            case Position.Last:
            default:
                leftBorder = hasBackground ? new Telerik.Windows.Documents.Model.Border(BorderStyle.None) : cellBorders.Left; ;
                rightBorder = new Telerik.Windows.Documents.Model.Border((float)thickness.Right, BorderStyle.Single, borderBrushColor);
                break;
        }

        return new TableCellBorders(leftBorder, topBorder, rightBorder, bottomBorder);
    }
}

private Telerik.Windows.Documents.Layout.RadVerticalAlignment GetVerticalAlignment(VerticalAlignment verticalAlignment)
{
    switch (verticalAlignment)
    {
        case VerticalAlignment.Bottom:
            return Telerik.Windows.Documents.Layout.RadVerticalAlignment.Bottom;

        case VerticalAlignment.Stretch:
        case VerticalAlignment.Center:
            return Telerik.Windows.Documents.Layout.RadVerticalAlignment.Center;

        case VerticalAlignment.Top:
        default:
            return Telerik.Windows.Documents.Layout.RadVerticalAlignment.Top;
    }
}

private Telerik.Windows.Documents.Layout.RadTextAlignment GetTextAlignment(TextAlignment textAlignment)
{
    switch (textAlignment)
    {
        case TextAlignment.Center:
            return Telerik.Windows.Documents.Layout.RadTextAlignment.Center;

        case TextAlignment.Justify:
            return Telerik.Windows.Documents.Layout.RadTextAlignment.Justify;

        case TextAlignment.Right:
            return Telerik.Windows.Documents.Layout.RadTextAlignment.Right;

        case TextAlignment.Left:
        default:
            return Telerik.Windows.Documents.Layout.RadTextAlignment.Left;
    }
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<p>Here is a simple method, that will export the document to the specified file stream. This method is used in all of the below cases.</p>

<h4><strong>C#</strong></h4>

<pre><code>private static void SaveFile(SaveFileDialog dialog, IDocumentFormatProvider provider, RadDocument document)
{
    var result = dialog.ShowDialog();
    if (result == true)
    {
        try
        {
            using (var stream = dialog.OpenFile())
            {
                provider.Export(document, stream);
            }
        }
        catch (IOException ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<p>Export To Word</p>

<blockquote>
<p>In order to use Export to Word functionality, you will have to add reference to the <strong>Telerik.Windows.Documents.FormatProviders.OpenXml</strong> assembly.</p>
</blockquote>

<p>After you've generated the document (instance of <strong>RadDocument</strong>) you have to set the <em>Document</em> property of <strong>RadRichTextBox</strong>.<br>
                Note that <strong>RadRichTextBox</strong> should be visible in order to create the document based on <em>Document</em> property.</p>

<h4><strong>C#</strong></h4>

<pre><code>private void WordExport_Click(object sender, RoutedEventArgs e)
{
    RadDocument document = GenerateRadDocument();
    richTextBox.Document = document;

    var provider = new DocxFormatProvider();
    SaveFileDialog dialog = new SaveFileDialog();
    dialog.DefaultExt = "docx";
    dialog.Filter = "Word document (docx) | *.docx |All Files (*.*) | *.*";
    SaveFile(dialog, provider, document);
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<p>Export To Pdf</p>

<blockquote>
<p>In order to use Export to pdf functionality, you will have to add reference to the <strong>Telerik.Windows.Documents.FormatProviders.Pdf</strong> assembly.</p>
</blockquote>

<p>After you've generated the document (instance of <strong>RadDocument</strong>) you have to set the <em>Document</em> property of <strong>RadRichTextBox</strong>.<br>
                Note that <strong>RadRichTextBox</strong> should be visible in order to create the document based on <em>Document</em> property.</p>

<h4><strong>C#</strong></h4>

<pre><code>private void PdfExport_Click(object sender, RoutedEventArgs e)
{
    RadDocument document = GenerateRadDocument();
    rtb.Document = document;

    var provider = new PdfFormatProvider();
    SaveFileDialog dialog = new SaveFileDialog();
    dialog.DefaultExt = "pdf";
    dialog.Filter = "Pdf document (pdf) | *.pdf |All Files (*.*) | *.*";
    SaveFile(dialog, provider, document);
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<p>Export To HTML</p>

<blockquote>
<p>In order to use Export to HTML functionality, you will have to add reference to the <strong>Telerik.Windows.Documents.FormatProviders.Html</strong> assembly.</p>
</blockquote>

<p>After you've generated the document (instance of <strong>RadDocument</strong>) you have to set the <em>Document</em> property of <strong>RadRichTextBox</strong>.<br>
                Note that <strong>RadRichTextBox</strong> should be visible in order to create the document based on <em>Document</em> property.</p>

<h4><strong>C#</strong></h4>

<pre><code>private void HtmlExport_Click(object sender, RoutedEventArgs e)
{
    RadDocument document = GenerateRadDocument();
    rtb.Document = document;

    var provider = new HtmlFormatProvider();
    SaveFileDialog dialog = new SaveFileDialog();
    dialog.DefaultExt = "html";
    dialog.Filter = "Html document (html) | *.html |All Files (*.*) | *.*";
    SaveFile(dialog, provider, document);
}
</code></pre>

<h4><strong>VB.NET</strong></h4>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/silverlight/radpivotgrid/getting-started">RadPivotGrid Getting Started</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/fieldlist">RadPivotFieldList</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/features">Features</a></p></li>
</ul>
        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik. All rights reserved.</p>
</footer>


    </body>
</html>

