<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Sorting</title>
        <link rel="shortcut icon" href="/devtools/silverlight/favicon.ico"/>
        <meta name="description" content="Sorting">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/silverlight/assets/styles-5bdcfd475585f36df16a95e0457f2f6f.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/theme-d2ae4bb8495446e1d4605832601ddc1a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/branding-a6bed66550d3e9b437d7b25da3bd997a.css">
        <link rel="stylesheet" href="/devtools/silverlight/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/app-552278fa51da4b2d25adc25f9fec90be.js"></script>
		<script src="/devtools/silverlight/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/silverlight/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
             <div id="page-header">

	<div id="logo-bar-sl">
		<a href="http://www.telerik.com" target="_blank" title="UI for Silverlight">
			<span>UI for Silverlight</span>
		</a>
	</div> 



	<div id="page-search">
        <script>
  (function() {
    var cx = '001595215763381649090:eblhnfskwrk';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

    </div>
</div> 


        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/devtools/silverlight/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            select: preventParentSelection,
            template: navigationTemplate("/devtools/silverlight/"),
            dataBound: expandNavigation("radpivotgrid/features/olap-providers/sorting-olap.html")
        });
        </script>
    </div>

    <div id="page-article">
        <div id="page-top">
            <div id="page-breadcrumb">
                <ul><li class="link"><a href="/devtools/silverlight/introduction/index">Home</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/overview">RadPivotGrid</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/features/layouts">Features1</a></li><li class="link"><a href="/devtools/silverlight/radpivotgrid/features/olap-providers/sorting-olap">olap-providers</a></li><li>Sorting</li></ul>
            </div>
        </div>

        <article>
            <h1 id="sorting"><a href="#sorting">Sorting</a></h1>

<p>In this article we will explain how to use sorting when your data is from OLAP Cube.</p>

<h2 id="understanding-sorting-mechanism"><a href="#understanding-sorting-mechanism">Understanding Sorting Mechanism</a></h2>

<p><strong>RadPivotGrid</strong> provides different sorting capabilities. You can sort your <em>RowGroupDescriptions</em> and <em>ColumnGroupDescriptions</em><br>
          ascending (from A to Z) and descending (from Z to A) based on the names of the properties they are showing or based on the aggregated description.</p>

<p>With the <strong>Q1 2014 SP1</strong> version of <strong>Telerik UI for</strong>Â <strong>RadPivotGrid</strong> provides two additional sorting options.<br>
          The data can be sorted by the Olap SortKeys using the new <strong>OlapGroupComparer</strong> or can be shown the way it has been received from the data source using the <strong>SortOrder</strong> property set to <strong>None</strong>.</p>

<p>We will explain this with a simple <strong>RadPivotGrid</strong>:<br>
        <img src="images/RadPivotGrid_Features_Sorting_OLAP_01.png" alt="Rad Pivot Grid Features Sorting OLAP 01"></p>

<p>The <strong>ColumnGroupDescription</strong> in this <strong>RadPivotGrid</strong> is <em>Category</em>. By default the sorting of the columns is ascending (from A to Z) based on the headers:<br>
          <em>Accessories</em>, <em>Bikes</em>, <em>Clothing</em>, <em>Components</em>. You can easily change the sorting of the <em>Category</em> ColumnGroupDescription and set it to descending (from Z to A). This will lead to the following result:<br>
        <img src="images/RadPivotGrid_Features_Sorting_OLAP_02.png" alt="Rad Pivot Grid Features Sorting OLAP 02"></p>

<p>The columns are reordered based on their names (check the green rectangle on the top of the image). You can apply sorting based on some of the <strong>measures</strong><br>
          you are using. In the example above you can apply sorting of the <em>Category</em> ColumnGroupDescription in ascending (from A to Z) or descending (from Z to A) format based on the <em>Total Reseller Order Quantity</em> (red rectangle) or <em>Total Reseller Order Count</em> (blue rectangle).<br>
          Here is the new view of <strong>RadPivotGrid</strong> when the <em>Category</em> ColumnGroupDescription is sorted in descending format based on the <em>Total Reseller Order Count</em>:<br>
        <img src="images/RadPivotGrid_Features_Sorting_OLAP_03.png" alt="Rad Pivot Grid Features Sorting OLAP 03"></p>

<blockquote class="important"><p>The sorting is set on the <strong>ColumnGroupDescriptions</strong> or <strong>RowGroupDescriptions</strong>. You cannot set sorting on the <strong>AggregateDescriptions</strong>, but you can sort</p></blockquote>

<pre><code>        the columns or rows based on the aggregated values.
</code></pre>

<h2 id="sort-the-data"><a href="#sort-the-data">Sort the data</a></h2>

<p>The sorting can be applied in the <strong>XAML</strong>, in code behind or even at runtime with the help of <strong>RadPivotFieldList</strong>.</p>

<ul>
<li>Sorting based on the GroupName (header) can be <em>Ascending (from A to Z)</em> or <em>Descending (from Z to A)</em>. The default value is <em>Ascending</em>, but you can change it by using <strong>SortOrder</strong> property:</li>
</ul>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:XmlaGroupDescription MemberName="[Product].[Category]" SortOrder="Ascending"&gt;
&lt;pivot:XmlaGroupDescription MemberName="[Product].[Category]" SortOrder="Descending"&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>XmlaGroupDescription groupDescription = new XmlaGroupDescription();
groupDescription.MemberName = "[Product].[Category]";
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Descending;
</code></pre>

<h4><strong>VB.NET</strong></h4>

<pre><code>Dim groupDescription As New XmlaGroupDescription()
groupDescription.MemberName = "[Product].[Category]"
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Descending
</code></pre>

<ul>
<li>If you need to avoid the data to be sorted anyhow, you can set the <strong>SortOrder</strong> property to <strong>None</strong>. This way the data will appear the way it is was
          received from the data source:</li>
</ul>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:XmlaGroupDescription MemberName="[Product].[Category]" SortOrder="None"&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>XmlaGroupDescription groupDescription = new XmlaGroupDescription();
groupDescription.MemberName = "[Product].[Category]";
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.None;
</code></pre>

<h4><strong>VB.NET</strong></h4>

<pre><code>Dim groupDescription As New XmlaGroupDescription()
groupDescription.MemberName = "[Product].[Category]"
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.None
</code></pre>

<blockquote>
<p>Note that the <strong>SortOrder None</strong> property is available with the <strong>Q1 2014 SP1</strong> version of Telerik UI for<br>
                Silverlight.</p>
</blockquote>

<ul>
<li>Sorting based on the GrandTotals (measures) can be <em>Ascending</em> or <em>Descending</em>. To set such sort mechanism you have to use the <strong>SortOrder</strong> and <strong>GroupComparer</strong> properties:</li>
</ul>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:XmlaGroupDescription MemberName="[Product].[Category]" SortOrder="Descending"&gt;
    &lt;pivot:XmlaGroupDescription.GroupComparer&gt;
        &lt;pivot:GrandTotalComparer AggregateIndex="1"/&gt;
    &lt;/pivot:XmlaGroupDescription.GroupComparer&gt;
&lt;/pivot:XmlaGroupDescription&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>XmlaGroupDescription groupDescription = new XmlaGroupDescription();
groupDescription.MemberName = "[Product].[Category]";
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Ascending;
groupDescription.GroupComparer = new GrandTotalComparer() { AggregateIndex = 1 };
</code></pre>

<h4><strong>VB.NET</strong></h4>

<pre><code>Dim groupDescription As New XmlaGroupDescription()
groupDescription.MemberName = "[Product].[Category]"
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Ascending
groupDescription.GroupComparer = New GrandTotalComparer() With {.AggregateIndex = 1}
</code></pre>

<blockquote>
<p>The <strong>AggregateIndex</strong> property is set based on the count of your aggregate descriptions. If you have two aggregates the first one will have <strong>AggregateIndex = 0</strong> and the second - <strong>AggregateIndex = 1</strong>.</p>
</blockquote>

<ul>
<li>Sorting based on the Olap SortKeys can be <em>Ascending</em> or <em>Descending</em>. To set such sort mechanism you have to use the <strong>SortOrder</strong> and <strong>GroupComparer</strong> properties:</li>
</ul>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:XmlaGroupDescription MemberName="[Product].[Category]" SortOrder="Descending"&gt;
    &lt;pivot:XmlaGroupDescription.GroupComparer&gt;
        &lt;pivot:OlapGroupComparer /&gt;
    &lt;/pivot:XmlaGroupDescription.GroupComparer&gt;
&lt;/pivot:XmlaGroupDescription&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>XmlaGroupDescription groupDescription = new XmlaGroupDescription();
groupDescription.MemberName = "[Product].[Category]";
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Ascending;
groupDescription.GroupComparer = new OlapGroupComparer();
</code></pre>

<h4><strong>VB.NET</strong></h4>

<pre><code>Dim groupDescription As New XmlaGroupDescription()
groupDescription.MemberName = "[Product].[Category]"
groupDescription.SortOrder = Telerik.Pivot.Core.SortOrder.Ascending
groupDescription.GroupComparer = New OlapGroupComparer()
</code></pre>

<blockquote>
<p>Note that the <strong>OlapGroupComparer</strong> is available with the <strong>Q1 2014 SP1</strong> version of Telerik UI for<br>
                Silverlight.<br>
              Sorting User-defined Hierarchies</p>
</blockquote>

<p>OLAP dimensions consist of attribute hierarchies and user-defined hierarchies.<br>
                User-defined hierarchies have different levels and with <strong>RadPivotGrid</strong> you can sort each of the levels. To do this you should use <em>Levels</em> property of <strong>XmlaGroupDescription</strong>.<br>
                <em>Levels</em> property is collection of <strong>XmlaLevelGroupDescriptions</strong>. Each of the LevelGroupDescriptions has its own <em>MemberName</em> and SortOrder properties:</p>

<h4><strong>XAML</strong></h4>

<pre><code>&lt;pivot:XmlaDataProvider.RowGroupDescriptions&gt;
    &lt;pivot:XmlaGroupDescription MemberName="[Date].[Calendar]"&gt;
        &lt;pivot:XmlaGroupDescription.Levels&gt;
            &lt;pivot:XmlaLevelGroupDescription MemberName="[Date].[Calendar].[Calendar Year]" SortOrder="Descending"/&gt;
        &lt;/pivot:XmlaGroupDescription.Levels&gt;
    &lt;/pivot:XmlaGroupDescription&gt;
&lt;/pivot:XmlaDataProvider.RowGroupDescriptions&gt;
</code></pre>

<h4><strong>C#</strong></h4>

<pre><code>XmlaGroupDescription topGroupDescription = new XmlaGroupDescription();
topGroupDescription.MemberName = "[Date].[Calendar]";
XmlaLevelGroupDescription levelGroupDescription1 = new XmlaLevelGroupDescription();
levelGroupDescription1.MemberName = "[Date].[Calendar].[Calendar Year]";
levelGroupDescription1.SortOrder = Telerik.Pivot.Core.SortOrder.Descending;
topGroupDescription.Levels.Add(levelGroupDescription1);
</code></pre>

<h4><strong>VB.NET</strong></h4>

<pre><code>Dim topGroupDescription As New XmlaGroupDescription()
topGroupDescription.MemberName = "[Date].[Calendar]"
Dim levelGroupDescription1 As New XmlaLevelGroupDescription()
levelGroupDescription1.MemberName = "[Date].[Calendar].[Calendar Year]"
levelGroupDescription1.SortOrder = Telerik.Pivot.Core.SortOrder.Descending
topGroupDescription.Levels.Add(levelGroupDescription1)
</code></pre>

<h2 id="changing-the-sorting-at-runtime"><a href="#changing-the-sorting-at-runtime">Changing the Sorting at runtime</a></h2>

<p><strong>RadPivotFieldList</strong> gives you the ability to change the sorting of a description at runtime. When you click on RowGroupDescription or ColumnGroupDescription<br>
          a new popup opens with several sorting options. If you want to save the current sorting, but only change its order (for example the above <strong>RadPivotGrid</strong> is sorted based on the Total Reseller Order Count in Descending order,<br>
          and you want to change it to Ascending) you can use the first two options which are doing exactly this - just changing the <strong>SortOrder</strong>:<br>
        <img src="images/RadPivotGrid_Features_Sorting_OLAP_04.png" alt="Rad Pivot Grid Features Sorting OLAP 04"></p>

<p>If you want to change the property based on which the sort is applied, then you can use the third option - More Sorting Options. A new RadWindow will be opened in which you can choose<br>
          Ascending or Descending order of the sort. When you click the dropdown button you'll see a full list of the possible sorting basis:<br>
        <img src="images/RadPivotGrid_Features_Sorting_OLAP_06.png" alt="Rad Pivot Grid Features Sorting OLAP 06"></p>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/silverlight/radpivotgrid/populating-with-data/data-localdatasource">LocalDataSourceProvider</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/fieldlist">RadPivotFieldList</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/features">Features</a></p></li>
<li><p><a href="/devtools/silverlight/radpivotgrid/features/localdatasourceprovider/filtering">Filtering</a></p></li>
</ul>
        </article>
    </div>
</div>

<footer>
    <p>Copyright &copy; 2002-2014 Telerik. All rights reserved.</p>
</footer>


    </body>
</html>

